<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!---<link href="index1.html" id="hoten">--->
    <title>trả lời</title>
</head>
<body>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <div class="heading">
        <h2>The Vitamin Shoppe</h2>
    </div>
    <!---<div class="input">
        <input type="text" id ="hoten" name="hoten" required>
        <input type="submit" name="submit" value="Login" id="sub">--->
    </div>
    <div class="content">
        <p1>Xin chào anh/chị <strong>Hovaten</strong> với các dữ liệu anh chị cung cấp, hệ thống AI của The Vitamin Shoppe xây dựng chế độ ăn dinh dưỡng phù hợp với bệnh benhcuakhach như sau:<br><br></p1>
    </div>
    <div id="prompt"></div>
    <div class="content">
        <p>
            <div id="output"><br></div>
            <div id="loading" style="display:none">Đang tải phản hồi...</div>
            <br>
        </p>
        <p>
            <div id="output1"><br></div>
            <div id="loading1" style="display:none">Đang tải phản hồi...</div>
        </p>
        <p>
            <div id="output2"><br></div>
            <div id="loading2" style="display:none">Đang tải phản hồi...</div>
        </p>
    </div>
    <div class="content">
        <p3>
        Để áp dụng chế độ dinh dưỡng cùng các biện pháp hiệu quả cho bệnh benhcuakhach sẽ có sự trợ giúp của các bạn TLSKCN tại The Vitamin Shoppe 
        </p3>
    </div>
    <a button="quay lại" href="index1.html">quay lại</a>
    <script>
        const hotenValue = sessionStorage.getItem('hotenValue');
        const benhValue = sessionStorage.getItem('benhValue');
        
        const p1 = document.querySelector('p1');
        const oldText = p1.innerHTML;
        const newText = oldText.replace('Hovaten', hotenValue);
        const newText1 = newText.replace('benhcuakhach', benhValue);
        p1.innerHTML = newText1;
       
        const p3 = document.querySelector('p3');
        const oldText3 = p3.innerHTML;
        const newText3 = oldText3.replace('benhcuakhach', benhValue);
        p3.innerHTML = newText3;
        
        const p2 = document.querySelector('p2');
        
// request
        const prompt = "Xây dựng thực đơn dinh dưỡng cụ thể từng bữa trong 7 ngày cho người bị bệnh tiểu đường" ;
        const prompt1="Thực phẩm chức năng cho bệnh tiểu đường";
        const prompt2 = "Lời khuyên của chuyên gia về chế độ sinh hoạt tập luyện cho bệnh tiểu đường" ;
        temperature: 0;
        const maxTokens = 2048;
        //const maxTokens = 4000;
        const engine = "text-davinci-003";
        //const engine ="code-davinci-002";
        // api key
        const apiKey = "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";
      
        const outputDiv = document.getElementById("output");
        const outputDiv1 = document.getElementById("output1");
        const outputDiv2 = document.getElementById("output2")
        const loadingDiv = document.getElementById("loading");
        const loadingDiv1 = document.getElementById("loading1");
        const loadingDiv2 = document.getElementById("loading2");
        
        const promt1 = document.getElementById("prompt")
        promt1.innerHTML = prompt;
        
        loadingDiv.style.display = "block";
        
        //prompt
        axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
            prompt: prompt,
            max_tokens: maxTokens,
            temperature: 0.7,
            n: 1,
            stop: null,
            }, {
            headers: { Authorization: `Bearer ${apiKey}` }
            })
            .then((response) => {
                const answer = response.data.choices[0].text;
                const list = answer.split(/\n\n/g);
                outputDiv.innerHTML = "<p>" + list[0] + "<br>" + list[1] + "<br>" + list[2] + "<br>" + list[3] +"<br>" + list[4] +"</p>" 
                                
                //const normalizedAnswer = answer.split('-').join('\n-').split('Thứ').join('\nThứ');
                //outputDiv.innerHTML = "<p>" + answer.replace(/\n/g,"<br>") + "</p>";
                //outputDiv.innerHTML = "<p>" + answer + "</p>";
            //outputDiv.innerHTML = "<p>" + answer + "</p>";
                loadingDiv.style.display = "none";
            })
        //prompt1
        axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
            prompt: prompt1,
            max_tokens: maxTokens,
            temperature: 0.7,
            n: 1,
            stop: null,
                }
            , {
            headers: { Authorization: `Bearer ${apiKey}` }
                })
            .then((response) => {
                //console.log(response);
                const answer1 = response.data.choices[0].text;
                const json = JSON.stringify(response.data.choices[0]);
                //const normalizedAnswer1 = answer.split('-').join('\n-').split('Thứ').join('\nThứ');
                //const traloi = answer1.replace("\n","<br>");
                //const chuanhoa = answer1.replace("/\n\n\d+/g","<br>")
                outputDiv1.innerHTML = "<p>" + answer1.replace(/\n/g,"<br>") + "</p>";
                //outputDiv1.innerHTML = "<p>" + chuanhoa + "</p>";
                loadingDiv1.style.display = "none";
                })
           //prompt2 
        axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
                prompt: prompt2,
                max_tokens: maxTokens,
                temperature: 0.7,
                n: 1,
                stop: null,
                }, {
                headers: { Authorization: `Bearer ${apiKey}` }
                })
                .then((response) => {
                    const answer3 = response.data.choices[0].text;
                //const normalizedAnswer = answer.split('-').join('\n-').split('Thứ').join('\nThứ');
                    outputDiv2.innerHTML = "<p> Lời khuyên của tôi " + answer3.replace(/\n/g,"<br>") + "</p>";
                    //outputDiv2.innerHTML = "<p>" + answer3 + "</p>";
                //outputDiv.innerHTML = "<p>" + answer + "</p>";
                    loadingDiv2.style.display = "none";
            })
            .catch((error) => {
            console.log(error);
            loadingDiv.style.display = "none";
            });
    </script>
</body>
</html>